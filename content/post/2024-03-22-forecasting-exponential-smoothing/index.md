---
title: 预测：方法与实践--指数平滑
author: 王哲峰
date: '2024-03-22'
slug: forecasting-exponential-smoothing
categories:
  - timeseries
tags:
  - book
---

<style>
details {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: .5em .5em 0;
}
summary {
    font-weight: bold;
    margin: -.5em -.5em 0;
    padding: .5em;
}
details[open] {
    padding: .5em;
}
details[open] summary {
    border-bottom: 1px solid #aaa;
    margin-bottom: .5em;
}
img {
    pointer-events: none;
}
</style>

<details><summary>目录</summary><p>

- [简单的指数平滑](#简单的指数平滑)
  - [加权平均形式](#加权平均形式)
  - [分量形式](#分量形式)
  - [平坦预测](#平坦预测)
  - [优化](#优化)
- [趋势性方法](#趋势性方法)
  - [霍尔特的线性趋势法](#霍尔特的线性趋势法)
  - [阻尼趋势法](#阻尼趋势法)
- [季节性方法](#季节性方法)
  - [Holt-Winters 加法模型](#holt-winters-加法模型)
  - [Holt-Winters 乘法模型](#holt-winters-乘法模型)
  - [Holt-Winters 的阻尼法](#holt-winters-的阻尼法)
- [指数平滑法的分类](#指数平滑法的分类)
- [新息指数平滑状态空间模型](#新息指数平滑状态空间模型)
- [模型估计和选择](#模型估计和选择)
- [使用 ETS 模型预测](#使用-ets-模型预测)
</p></details><p></p>

指数平滑是在 20 世纪 50 年代后期提出的(Brown，1959; Holt，1957; Winters，1960)，
其激发了一些十分成功的预测方法。
<span style='border-bottom:1.5px dashed red;'>使用指数平滑方法生成的预测是过去观测值的加权平均值，
并且随着过去观测值离预测值距离的增大，权重呈指数型衰减。换句话说，观察值越近，相应的权重越高。</span>
该框架能够快速生成可靠的预测结果，并且适用于广泛的时间序列，这是一个巨大的优势并且对于工业应用来说非常重要。

这里分两部分介绍：

* 第一部分介绍了最重要的指数平滑方法的机制，
  以及该方法在预测具有不同特征的时间序列中的应用，
  这有助于我们对这些方法如何运作有一种直观的认识。
  在这种情况下，选择和使用预测方法可能会有点特殊。
  该方法的选择通常基于识别时间序列的关键因素（趋势和季节），
  以及它们应用平滑方法的方式（例如，以加性，阻尼或乘性方式）。
* 第二部分介绍构成指数平滑方法基础的统计模型。
  这些模型与第一部分讨论的方法能够生成相同的点预测，
  同时也能生成预测区间。此外，这个统计框架能在竞争模型之间进行真正的模型选择。

# 简单的指数平滑

最简单的指数平滑方法自然被称为 <span style='border-bottom:1.5px dashed red;'>简单指数平滑(SES)</span>。
这种方法适用于预测没有明显趋势或季节因素的数据。

如果数据中没有显示任何明确的趋势或季节性因素，
应该考虑对这样的数据使用朴素预测和平均法进行预测：

* 使用 <span style='border-bottom:1.5px dashed red;'>朴素法</span>，
  对未来的所有预测都等于该序列的最后一个观测值：

    `$$\hat{y}_{T+h|T}=y_{T}$$`

    其中：`$h=1，2，...$`

    因此，朴素法假设最近的观测值是唯一重要的观测值，并且之前所有的观测值都不提供未来的信息。
    这可以看作是一个加权平均值，其中所有的权重都被赋给了最后一次观测值。

* 使用 <span style='border-bottom:1.5px dashed red;'>平均值</span>，
  所有未来预测值都等于观测数据的简单平均值：

    `$$\hat{y}_{T+h|T}=\frac{1}{T}\sum_{t=1}^{T}y_{t}$$`

    其中：`$h=1，2，...$`

    因此，平均法假设所有观测值具有同等重要性，并在预测时给予相同的权重。

我们经常需要的是在这两个极端方法之间的方法。例如，
可能明智的做法是将更大的权重赋到最近的观测值而不是过去的观测值。
这正是简单指数平滑背后的原理。预测值使用加权平均值进行计算，
其中权重随观测时间的久远程度呈指数型下降——最早的观察值被赋予最小的权值：

`$$\hat{y}_{T+1|T}=\alpha y_{T}+\alpha(1-\alpha)y_{T-1}+\alpha(1-\alpha)^{2}y_{T-2}+\cdots$$`

其中：

* `$0 \leq \alpha \leq 1$` 是平滑参数
* 向前一步 `$T+1$` 时刻的预测值是时间序列 `$y_{1}，\cdots，y_{T}$` 中所有观测值的加权平均值
* 权重下降的速度由参数 `$\alpha$` 控制

下表展示了在使用简单指数平滑进行预测时，
四个不同的 `$\alpha$` 值所对应的观察值的权重。

![img](images/ses.png)

对于任何合理的样本量，即使 `$\alpha$` 数值很小，权重的总和也应该近似为 1。
对于 0 到 1 之间的任何 `$\alpha$` 值，随着时间向前推移，观察值的权重呈指数型下降，
因此我们称之为“指数平滑”。

* 如果 `$\alpha$` 很小（即接近于0），那么更远的过去的观测值会被赋予更多的权重。
* 如果 `$\alpha$` 很大（即接近 1），则赋予更多的权重给最近的观测值。
* 对于 `$\alpha=1$`，`$\hat{y}_{T+1|T}=y_{T}$` 的极端情况，指数平滑的预测值等于朴素预测值。

## 加权平均形式


## 分量形式


## 平坦预测


## 优化



# 趋势性方法

## 霍尔特的线性趋势法

## 阻尼趋势法

# 季节性方法

## Holt-Winters 加法模型

## Holt-Winters 乘法模型

## Holt-Winters 的阻尼法

# 指数平滑法的分类

指数平滑法并不局限于前面的提出的这些方法。通过考虑趋势和季节分量的不同组合变化，
可以得到 9 种指数平滑方法。如果每种方法都由一对字母组合 `$(T，S)$` 标记，
分别表示“趋势”和“季节”成分。例如，`$(A，M)$` 是具有加性趋势和乘性季节性的方法；
`$(A_{d}，N)$` 是具有衰减趋势且没有季节性的方法等等。

![img](images/ses_class.png)

其中一些方法我们已经知道它们有其他名称：

![img](images/ses_class2.png)

# 新息指数平滑状态空间模型


# 模型估计和选择


# 使用 ETS 模型预测

