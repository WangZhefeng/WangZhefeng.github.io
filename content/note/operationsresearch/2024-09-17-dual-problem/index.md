---
title: 对偶问题
subtitle: Dual Problem
author: 王哲峰
date: '2024-09-17'
slug: dual-problem
categories:
  - optimizer algorithm
tags:
  - model
---

<style>
details {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: .5em .5em 0;
}
summary {
    font-weight: bold;
    margin: -.5em -.5em 0;
    padding: .5em;
}
details[open] {
    padding: .5em;
}
details[open] summary {
    border-bottom: 1px solid #aaa;
    margin-bottom: .5em;
}
img {
    pointer-events: none;
}
</style>

<details><summary>目录</summary><p>

- [对偶问题简介](#对偶问题简介)
- [对偶问题的形式](#对偶问题的形式)
- [对称形式对偶](#对称形式对偶)
- [对偶单纯形](#对偶单纯形)
- [对偶问题的应用](#对偶问题的应用)
</p></details><p></p>

# 对偶问题简介

线性规划的对偶问题可以将原问题和对偶问题看成是一个问题的两个视角。

如在一定资源下如何安排生产才能使利润最大，
这个问题的另一个角度就是怎样购买这些生产资源使花钱最少。

从数学的角度来说，如果原问题不好求解，可以尝试从对偶问题的角度出发求解原问题，
如在求最小问题中，对偶问题就是寻找原问题目标函数的下界。

# 对偶问题的形式

一个简答的资源优化问题：有三台设备分别是 A、B、C，
每种设别生产的成本为 `$y_{1}$`、`$y_{2}$`、`$y_{3}$`(单位：`$\text{元/h}$`)；
需要生产两种产品：甲、乙，甲和乙分别生产 `$x_{1}$`、`$x_{2}$`(单位：`$\text{kg}$`)，
其耗时和利润如表：

| 设备/产品 | 设备 A(`$y_{1}$`) | 设备 B(`$y_{2}$`) | 设备 C(`$y_{3}$`) | 利润(元/kg) |
|---------------------------|----|----|----|----|
| 产品甲(`$x_{1}$`) | 3 | 5 | 9 | 70 |
| 产品乙(`$x_{2}$`) | 9 | 5 | 3 | 30 |
| 限制工时(`$\text{h}$`)                | 540 | 450 | 720 | / |

从收益的角度来说是：如何安排生产使利润最大；
从成本的角度来说是：如何安排生产使在满足生产要求下设备的总台时价（成本）最小。
因此，可以写出原问题和对偶问题的数学表达式。

> 从成本角度来看：

`$$\text{min}\space D = 540y_{1}+450y_{2}+720y_{3}$$`
`$$\text{s.t.}\space\begin{cases}
3y_{1} + 5y_{2} + 9y_{3} \geq 70 \\
9y_{1} + 5y_{2} + 3y_{3} \geq 30 \\
y_{1}, y_{2}, y_{3} \geq 0
\end{cases}$$`

最优解是：`$Y^{*}=(y_{1}, y_{2}, y_{3})^{T}=(0, 2, 20/3)^{T}$`，`$D^{*}=5700$`。

> 从利润角度来看：

`$$\text{max}\space Z = 70x_{1} + 30x_{2}$$`
`$$\text{s.t.}\space\begin{cases}
3x_{1} + 9x_{2} \leq 540 \\
5x_{1} + 5x_{2} \leq 450 \\ 
9x_{1} + 3x_{2} \leq 720 \\
x_{1}, x_{2} \geq 0
\end{cases}$$`

最优解是：`$X^{*}=(x_{1}, x_{2})^{T}=(75, 15)^{T}$`，`$Z^{*}=5700$`。

因此，可以总结出原问题和对偶问题的关系如下：

1. 原问题是求 `$\text{max}$`，对偶问题是求 `$\text{min}$`；
2. 原问题有两个变量，对偶问题有两个约束条件；
3. 原问题有三个约束，对偶问题有三个变量；
4. 原问题目标函数系数是对偶问题约束方程的常数项；
5. 原问题的约束方程常数是对偶问题目标函数的系数；
6. 原问题约束方程系数矩阵是对偶问题约束方程系数矩阵的转置。

写成标准规范式是：

> Primal:

`$$\text{max}\space Z = CX$$`
`$$\text{s.t.}\space\begin{cases}
AX \leq b \\
X \geq 0 
\end{cases}$$`

> Dual:

`$$\text{min}\space D = b^{T}Y$$`
`$$\text{s.t.}\space\begin{cases}
A^{T}Y \geq C^{T} \\
Y \geq 0
\end{cases}$$`

回忆一下在列生成法中，因为原问题只有四个约束方程，所以对偶问题也就只有四个变量。

对偶问题有以下几个性质：

1. 可逆性，对偶问题的对偶是原问题；
2. 弱对偶性，设有如下互为对偶的两个问题：

    > Primal:

    `$$\text{max}\space Z = CX$$`
    `$$\text{s.t.}\space\begin{cases}
    AX \leq b \\
    X \geq 0 
    \end{cases}$$`

    > Dual:

    `$$\text{min}\space D = b^{T}Y$$`
    `$$\text{s.t.}\space\begin{cases}
    A^{T}Y \geq C^{T} \\
    Y \geq 0
    \end{cases}$$`

    设 `$X^{*}$` 和 `$Y^{*}$` 是原问题和对偶问题的可行解，则其对应的目标函数有如下关系：

    `$$Z = CX \leq D = b^{T}Y^{*}$$`

    当 `$Z=CX^{*}=D=b^{T}Y^{*}$` 时，`$X^{*}$` 和 `$Y^{*}$` 是原问题和对偶问题的最优解。

    上述性质称为弱对偶性，利用弱对偶性可以得到规划问题的上界或下界。

3. 无界性，若原问题（对偶问题）的解无界的，则其对偶问题（原问题）无可行解；
4. 可行解是最优解时的性质，若 `$X^{*}$` 时原问题的可行解，`$Y^{*}$` 是对偶问题的可行解，
   当 `$CX^{*}=b^{T}Y^{*}$` 时，`$X^{*}$` 和 `$Y^{*}$` 是原问题和对偶问题的最优解；
5. 对偶定理，若一个问题有最优解，则另一个问题必有最优解，而且它们的最优目标函数值相等（`$Z=D$`）；
6. 互补松弛定理，在互为对偶的两个问题中，若一个问题的某个变量取正数，则另一个问题的相应的约束条件必取等式，
   若一个问题的某个约束条件取不等式，则另个一问题相应的变量为 0。

# 对称形式对偶

因为对偶形式和在列生成法中提到的对偶形式并不相同，所以有必要说一下非对称形式对偶的推导过程，
应考虑如下形式的规划问题：

`$$\text{min}\space c^{T}x$$`
`$$\text{s.t.}\space\begin{cases}
Ax \geq b \\
x \geq 0 
\end{cases}$$`

其对偶问题的形式如下：

`$$\text{max}\space D = \lambda^{T}b$$`
`$$\text{s.t.}\space\begin{cases}
\lambda^{T}Y \leq c^{T} \\
\lambda \geq 0
\end{cases}$$`

对于线性规划的标准型，其约束形式为 `$Ax = b$`，等价于：

`$$Ax \geq b$$`
`$$-Ax \leq -b$$`

因此含有等式约束的原问题可以写成：

`$$\text{min}\space c^{T}x$$`
`$$\text{s.t.}\space\begin{cases}
\begin{bmatrix}A \\ -A\end{bmatrix} x \geq \begin{bmatrix}b \\ -b\end{bmatrix} \\
x \geq 0
\end{cases}$$`

这与对称形式的原问题具有相同的结构，因此上述问题的对偶问题为：

`$$\text{max}\begin{bmatrix}u^{T} & v^{T}\end{bmatrix}\begin{bmatrix}b \\ -b\end{bmatrix}$$`
`$$\text{s.t.}\space\begin{cases}
\begin{bmatrix}u^{T} & v^{T}\end{bmatrix} \begin{bmatrix}b \\ -b\end{bmatrix} \leq c^{T} \\
u, v \geq 0
\end{cases}$$`

可以整理成：

`$$\text{max}\space (u-v)^{T}b$$`
`$$\text{s.t.}\space\begin{cases}
(u-v)^{T}A \leq c^{T} \\
u, v \geq 0
\end{cases}$$`

令 `$\lambda = u-v$`，上述问题可变成：

`$$\text{max}\space \lambda^{T}b$$`
`$$\text{s.t.}\space\lambda^{T}A \leq c^{T}$$`

此时由于 `$u$` 和 `$v$` 的元素大于等于 0，`$\lambda = u-v$`，
没有了非负约束，因此这种形式就成了非对称形式的对偶。

# 对偶单纯形

如果对偶规划问题使用单纯形法求解，这个过程称为对偶单纯形法。
根据对偶理论性质，很容易得出，单纯形过程和对偶单纯形过程的关系如图：

* 单纯形法
    - 从一个初始基可行解出发
    - 检验数可正、可负
    - 保持右边常数非负（解的可行性）
    - 检验数均小于等于 0，则为最优解
* 对偶单纯形法
    - 从一个初始正则解出发
    - 右边常数可正、可负
    - 保持检验数非正（解的正则性）
    - 右边常数均大于等于 0，则为最优解

# 对偶问题的应用

前面讲解了对偶问题的相关知识，那么对偶问题到底有什么用呢？其实对偶问题更像一种解题技巧，
使用好并不简单，对偶问题的意义如下。

1. 对偶问题可以理解为同一问题的另一个方面。如在有限的资源条件下，生产利润最大。
   其对偶面就是，收买这些生产资源，花的钱最少。两者的结果应该是相同的。
2. 弱对偶定理给原问题的最优解定了一个界，强对們定理给出了原问题最优解的一个判定系件。
   可以化难为易（把难以求解的约東条件放到对偶问题的目标函数的位置上），
   如果问题的形式是变量少且的束多，还可以通过约束变量和对偶变量互换将大规模问题转换成小规模问题。
3. 在一些非凸问题或整数规划问题中，强对偶定理不一定成立，但是通过弱对偶定理往往能得到对原问题的一个下界，
   这对于求解原问题有时会有非常大的帮助，如在整数规划中的分支定界法，实际上就是凸问题，
   各种原始-对偶算法也往往比单纯的原始问题方法更有效，如对偶单纯形法一般认为比单纯形法要好。
4. 如果原问题比较复杂而对偶问题相对较为简单时，可以通过对偶问题来判断原问题是否有行解，
   这点从对偶性质的无界性中可以得出，因此，通过对偶问题能快速了解原问愿的基本情况。

如果使用现代求解器，可以直接从求解器的求解结果中得到对偶同题的解。
