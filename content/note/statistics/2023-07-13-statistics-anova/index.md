---
title: 统计方差分析
author: 王哲峰
date: '2023-07-13'
slug: statistics-anova
categories:
  - 数学、统计学
tags:
  - article
---

<style>
details {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: .5em .5em 0;
}
summary {
    font-weight: bold;
    margin: -.5em -.5em 0;
    padding: .5em;
}
details[open] {
    padding: .5em;
}
details[open] summary {
    border-bottom: 1px solid #aaa;
    margin-bottom: .5em;
}
img {
    pointer-events: none;
}
</style>

<details><summary>目录</summary><p>

- [方差分析简介](#方差分析简介)
- [方差分析理论](#方差分析理论)
  - [单因子方差分析](#单因子方差分析)
  - [多因子方差分析](#多因子方差分析)
</p></details><p></p>

# 方差分析简介

对于多个总体均值的比较问题, 处理这类问题通常采用所谓的方差分析方法

# 方差分析理论

## 单因子方差分析

问题描述：

通常, 在单因子试验中, 记因子为 `$A$` , 
设其有 `$r$` 个水平, 记为 `$A_{1}, A_{2}, \cdots, A_{r}$` , 
在每一个水平下考察的指标可以看成一个总体, 现有 `$r$` 个水平, 
故有 `$r$` 个总体, 假定如下，并且这三个假定都可以用统计方法进行验证:

* (1) 每一个总体均为正态总体, 记为 `$N(\mu_{i}, \sigma_{i}^{2}), i=1,2, \cdots, r$`. 利用正态性验证成立.
* (2) 各总体的方差相同, 记为 `$\sigma_{1}^{2} = \sigma_{2}^{2} = \cdots = \sigma_{r}^{2} = \sigma^{2}$`. 利用方差齐性检验验证成立.
* (3) 从每一总体中抽取的样本是相互独立的, 即所有的试验结果 `$y_{ij}$` 都相互独立. 可由随机化实现, 这里的随机化是指所有试验按随机次序进行.

接下来要做的工作就是比较各水平下的均值是否相同，即要对如下的一个假设进行检验:

`$$H_{0}: \mu_{1} = \mu_{2} = \cdots = \mu_{r}.$$`

其备择假设为:

`$$H_{1}: \mu_{1}, \mu_{2}, \cdots, \mu_{r} 不全相等.$$`

> 在不会引起误会的情况下 `$H_{1}$` 通常可省略不写.

* 问题讨论：
    - 如果 `$H_{0}$` 成立，因子 `$A$` 的 `$r$` 个水平均值相同，
      称因子 `$A$` 的 `$r$` 个水平间没有显著差异，简称因子 `$A$` 不显著;
    - 反之，当 `$H_{0}$` 不成立时，因子 `$A$` 的 `$r$` 个水平均值不全相同，
      这时称因子 `$A$` 的不同水平间有显著差异，简称因此 `$A$` 显著.
* 进行试验:
    - 为了对假设 `$H_{0}$` 进行试验，需要从每一水平下的总体抽取样本，
      设从第 `$i$` 个水平下的总体获得 `$m$` 个试验结果，
      记 `$y_{ij}$` 表示第 `$i$` 个总体的第 `$j$` 次重复试验结果，
      共得如下 `$r \times m$` 个试验结果:

`$$y_{ij}, i = 1, 2, \cdots, r, j=1, 2, \cdots, m.$$`

* 其中: `$r$` 为水平数，`$m$` 为重复数，`$i$` 为水平编号，`$j$` 为重复序号.
    - 在水平 `$A_{i}$` 下的试验结果 `$y_{ij}$` 与该水平下的指标均值 `$\mu_{i}$` 一般总是有差距的，
      记 `$\epsilon_{ij} = y_{ij} - \mu_{i}$` , `$\epsilon_{ij}$` 称为随机误差，于是有:

`$$y_{ij} = \mu_{i} + \epsilon_{ij}$$`

* 上式称为试验结果 `$y_{ij}$` 的数据结构式, 把三个假定用于数据结构式就可以写出单因子方差分析的统计模型.
* 单因子方差分析的统计模型

`$$\begin{cases}
y_{ij} = \mu_{i} + \epsilon_{ij}, i = 1, 2, \cdots, r, j=1, 2, \cdots, m. \\
诸 \epsilon_{ij} 相互独立，且都服从 N(0, \sigma^{2})
\end{cases}$$`
 
> 为了更好地描述数据，常在方差分析中引入总均值与水平效应的概念，
  称诸 `$\mu_{i}$` 的平均(所有试验结果的均值的平均)为总均值，也称一般平均。

`$$\mu = \frac{1}{r}(\mu_{1} + \mu_{2} + \cdots + \mu_{r}) = \frac{1}{r}\sum_{i=1}^{r}\mu_{i}$$`

称第 `$i$` 水平下的均值 `$\mu_{i}$` 与总均值 `$\mu$` 的差为因子 `$A$` 的第 `$i$` 水平的主效应，
简称为 `$A_{i}$` 的水平效应:

`$$a_{i}=\mu_{i} - \mu, i = 1, 2, \cdots, r.$$`

容易看出第 `$i$` 个总体均值是由总均值与该水平效应叠加而成的:

`$$\begin{cases}
\sum_{i=1}^{r}a_{i}=0 \\
\mu_{i} = \mu + a_{i}
\end{cases}$$`

`$$\begin{cases}
y_{ij} = \mu + a_{i} + \epsilon_{ij}, i = 1, 2, \cdots, r, j=1, 2, \cdots, m. \\
\sum_{i=1}^{r}a_{i}=0, \\
\epsilon_{ij} 相互独立，且都服从 N(0, \sigma^{2}).
\end{cases}$$`

* 单因子方差分析的假设

原假设:

`$$H_{0}: a_{1} = a_{2} = \cdots = a_{r}.$$`

其备择假设为:

`$$H_{1}: a_{1}, a_{2}, \cdots, a_{r} 不全相等.$$`

## 多因子方差分析

