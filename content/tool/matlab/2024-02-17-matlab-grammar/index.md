---
title: MATLAB 基础语法
author: 王哲峰
date: '2024-02-17'
slug: matlab-grammar
categories:
  - MATLAB
tags:
  - tool
---

<style>
details {
    border: 1px solid #aaa;
    border-radius: 4px;
    padding: .5em .5em 0;
}
summary {
    font-weight: bold;
    margin: -.5em -.5em 0;
    padding: .5em;
}
details[open] {
    padding: .5em;
}
details[open] summary {
    border-bottom: 1px solid #aaa;
    margin-bottom: .5em;
}
img {
    pointer-events: none;
}
</style>

<details><summary>目录</summary><p>

- [Matlab 语句](#matlab-语句)
    - [语句形式](#语句形式)
    - [分号和续行符的作用](#分号和续行符的作用)
- [Matlab 变量](#matlab-变量)
    - [变量命名规则](#变量命名规则)
    - [变量查询](#变量查询)
    - [系统预定义变量](#系统预定义变量)
    - [变量的存储](#变量的存储)
    - [变量的读取](#变量的读取)
    - [变量的清除](#变量的清除)
- [Matlab 数学运算符](#matlab-数学运算符)
    - [一般运算符](#一般运算符)
    - [点乘、点除、点幂](#点乘点除点幂)
    - [运算输出格式](#运算输出格式)
- [Matlab 矩阵数值计算](#matlab-矩阵数值计算)
    - [矩阵的定义](#矩阵的定义)
    - [矩阵赋值操作](#矩阵赋值操作)
    - [矩阵元素提取引用操作](#矩阵元素提取引用操作)
        - [单个元素的引用](#单个元素的引用)
        - [多个元素的引用](#多个元素的引用)
        - [生成等差数列向量](#生成等差数列向量)
    - [建立矩阵进阶](#建立矩阵进阶)
    - [建立矩阵的函数](#建立矩阵的函数)
    - [数组运算](#数组运算)
    - [其他](#其他)
- [Matlab 符号运算](#matlab-符号运算)
    - [符号对象的建立](#符号对象的建立)
    - [查找符号变量](#查找符号变量)
    - [替换符号变量](#替换符号变量)
    - [因式分解](#因式分解)
    - [函数展开](#函数展开)
    - [合并同类项](#合并同类项)
    - [函数简化](#函数简化)
    - [计算极限](#计算极限)
    - [计算导数](#计算导数)
    - [计算积分](#计算积分)
    - [符号求和](#符号求和)
    - [代数方程求解](#代数方程求解)
    - [微分方程求解](#微分方程求解)
- [Matlab 程序设计](#matlab-程序设计)
    - [M 文件](#m-文件)
    - [程序设计](#程序设计)
        - [for 语句](#for-语句)
        - [while 语句](#while-语句)
    - [函数文件](#函数文件)
        - [函数创建](#函数创建)
        - [函数调用](#函数调用)
    - [全局变量和局部变量](#全局变量和局部变量)
- [参考](#参考)
</p></details><p></p>

# Matlab 语句

## 语句形式

Matlab 语句的通常形式为：

```matlab
变量 = 表达式;
```

## 分号和续行符的作用

* 如果不想在命令行窗口窗口的屏幕上输出结果，可以在语句最后加上分号
* 如果语句很长，可用续行符 `...` 续行，续行符的前面最好留一个空格    

```matlab
a = 1  % a=1 会在命令行窗口输出
b = 1;  % 加了分号就不显示在命令行窗口
c = 123 + 456 + 789 + ...
    12345;  % 三个点换行
```

# Matlab 变量

## 变量命名规则

Matlab 变量的命名与其他编程语言的规则相似：可以由字母、数字、下划线构成，
其中必须以字母或下划线开头，且变量名区分字母的大小写。

## 变量查询

* `who` 显示工作空间种的所有变量

```Matlab
>> a = 1;
>> b = 2;
>> c = pi;
```

```matlab
>> who
```

```
您的变量为:

a  b  c 
```

* `whos` 查看工作空间中变量的详细属性

```matlab
>> whos
```

```
Name  Size  Bytes Class  Attributes

a     1x1   8            double
b     1x1   8            double
c     1x1   8            double
```

## 系统预定义变量

* `pi`：圆周率 `$\pi$`
* `inf`、`Inf`：无穷大
* `nan`、`NaN`：Not a Number，一个不定值，如 0/0
* `eps`：浮点运算相对精度    
* `i`, `j`：虚部单位，通常为了避免混淆写作 `1i`，`1j`
* 特殊变量 `ans`：应尽量避免系统预定义变量重新赋值

## 变量的存储

语法：

```matlab
save 文件名 变量名列表  % 变量名列表中各变量之间用空格分隔
save(文件名, 变量名1, 变量名2)
```

示例：

```matlab
% 将变量 p 与 q 存储到文件 file1.mat 里
save 'file1.mat' p q

% 或者
save('file1.mat', 'p', 'q')
```

## 变量的读取

从数据文件中提取指定变量：

```matlab
load mydata A x
```

## 变量的清除

清除当前工作空间中的变量：

```matlab
% 清除指定的变量
clear A x

% 清除所有工作空间中的变量
clear all
```

# Matlab 数学运算符

## 一般运算符

* `+`
* `-`
* `*`
* `/`, `\`：(右左除)
* `^`：幂运算

## 点乘、点除、点幂

```matlab
x = [1 2 3];
y = [2 4 6];

% 输出 1*2 2*4 3*6
x.*y;

% 输出 2/1 4/2 6/3
y./x;

% 输出 1^3 2^3 3^3
x.^3; 
```

## 运算输出格式

* Matlab 以双精度执行所有的运算，运算结果可以在屏幕上输出，同时赋给指定变量；
* 若无指定变量，则系统会自动将结果赋给变量 `ans`；
* Matlab 中数的输出格式可以通过 `format` 命令指定；`format` 只改变变量的输出格式，但不会影响变量的值。

# Matlab 矩阵数值计算

## 矩阵的定义

* 矩阵用方括号 `[]` 括起
* 矩阵同一行中的元素之间用空格或逗号分隔
* 矩阵行与行之间用分号分开
* 直接输入法中，分号可以用回车代替

```matlab
A = [1, 2, 3; 4, 5, 6; 7, 8, 9];

% 或者
A = [1 2 3; 4 5 6; 7 8 9];

% 或者
A = [1 2 3;
     4 5 6;
     7 8 9];

% 或者
A = [1, 2, 3;
     4, 5, 6;
     7, 8, 9];

% 或者
A = [1, 2, 3
     4, 5, 6
     7, 8, 9];
```

## 矩阵赋值操作

矩阵 A 是一个 `$1 \times 2$` 矩阵，第一个元素是 `1`，第二个元素 `2`

```matlab
A(1) = 1;
A(2) = 2;
```

大矩阵可以把小矩阵作为其元素：

```matlab
A = [A; 3 4];
```

## 矩阵元素提取引用操作

### 单个元素的引用

* 利用小括弧和元素所在的位置(下标)
* `A(1)`：向量 `A` 的第一个元素
* `A(i)`：向量 `A` 中的第 `i` 个元素
* `A(i, j)`：矩阵 `A` 中的第 `i` 行，第 `j` 列元素；

### 多个元素的引用

矩阵元素的引用：`A(i:j, m:n)` 表示由矩阵 `A` 的第 `i` 到第 `j` 行，和第 `m` 到第 `n` 列交叉线上的元素组成的子矩阵。
可以利用冒号 `:` 提取矩阵的整行或整列。

```matlab
A(1, :)
A(:, 1:3)
A(:, :)
```

### 生成等差数列向量

`a: b :c`：产生一个由等差序列组成的向量

其中：

* `a` 是首项，`b` 是公差，`c` 确定最后一项
* 若 `b` 等于 1，则 `b` 可以省略

## 建立矩阵进阶

* 利用函数建立数值矩阵：MATLAB 提供了许多生成和操作矩阵的函数
  例如: `reshape` 函数和 `diag` 函数等。
    - `reshape` 函数用于建立数值矩阵
    - `diag` 函数用于产生对角阵

```matlab
x = 1:12;
y = reshape(x, 3, 4)

z = 1:4
diag(z)
```

* 利用 M 文件建立矩阵：对于比较大且比较复杂的矩阵，可以为它专门建立一个 M 文件
* 矩阵的基本运算：
    - 矩阵转置：`A .'`
    - 矩阵共轭转置：`A'`
    - 矩阵加、减、乘、除
    - 矩阵的乘方：`A^2`

## 建立矩阵的函数

```matlab
eye(size(A))      % 产生与 A 矩阵同阶的单位矩阵
zeros(m, n)       % 产生 0 矩阵
ones(m, n)        % 产生 1 矩阵
rand (m, n)       % 产生随机元素的矩阵
size(a)           % 返回包含两个元素的向量
length(a)         % 返回向量的长度
```

## 数组运算

1. 数组的加、减、乘、除
2. 数组的乘方

## 其他

1. 行列式计算

```matlab
det[1, 2; 3, 4];
```

2. 求解线性方程组

```matlab
x = A \ b
```

3. 特征值问题

```matlab
eig(A)
```

# Matlab 符号运算

## 符号对象的建立

* sym

```matlab
符号变量 = sym(A)
```

* syms

```matlab
syms 符号变量1 符号变量2 ... 符号变量n
```

## 查找符号变量

> 查找符号表达式种的符号变量

* `findsym(expr)` 按字母顺序列出符号表达式 `expr` 中的所有符号变量
* `findsym(expr, N)` 按顺序列出符号表达式 `expr` 中离 `$x$` 最近的 N 个符号变量

## 替换符号变量

> 用给定的数据替换符号表达式中的指定符号变量


```matlab
% 用 a 替换字符函数 f 中的字符变量 x
subs(f, x, a)
```

## 因式分解

```matlab
% 符号变量
syms x;

% 符号表达式
f = x^6 + 1;

% 因式分解
factor(f)
```

## 函数展开

```matlab
% 符号变量
syms x;

% 符号表达式
f = (x + 1)^6

% 函数展开
expand(f)
```

## 合并同类项

```matlab
% 按指定变量 v 进行合并
collect(f, v)
```

## 函数简化

```matlab
% y 为 f 的最简短形式，How 中记录的是简化过程中使用的方法
[How, y] = simple(f)
```

## 计算极限

```matlab
% 当变量 x 趋向于 a 时 f 的极限
limit(f, x, a);

% 当默认变量趋向于 a 时 f 的极限
limit(f, a);

% 计算 a=0 时的极限
limit(f);

% 计算右极限
limit(f, x, a, 'right');

% 计算左极限
limit(f, x, a, 'left');
```

## 计算导数

```matlab
% 求符号表达式 f 关于 v 的导数
g = diff(f, v);

% 求符号表达式 f 关于默认变量的导数
g = diff(f);

% 求 f 关于 v 的 n 阶导数
g = diff(f, v, n);
```


## 计算积分

```matlab
% 计算定积分
int(f, v, a, b);

% 计算关于默认变量的定积分
int(f, a, b);

% 计算不定积分
int(f, v);

% 计算关于默认变量的不定积分
int(f);
```

## 符号求和

```matlab
symsum(f, v, a, b)
```

## 代数方程求解

```matlab
% 求方程关于指定自变量的解
solve(f, v)
```

## 微分方程求解

```matlab
y = dsolve('eq1', 'eq2', ... , 'cond1', 'cond2', ... , 'v')
```

其中：

* `y` 为输出的解
* `eq1`、`eq2`、`...` 为微分方程
* `cond1`、`cond2`、`...` 为初值条件
* `v` 为自变量

# Matlab 程序设计

## M 文件

用 MATLAB 语言编写的程序，称为 M 文件。M 文件有两类：

* 命令文件：没有输入参数，也不返回输出参数
* 函数文件：可以输入参数，也可返回输出参数
    - `input` 函数：用于向计算机输入一个参数
    - `pause` 函数：暂停程序的执行
    - `disp` 函数：命令窗口输出函数

## 程序设计

### for 语句

语法：

```matlab
for 循环变量 = 表达式1:表达式2:表达式3
    循环体语句
end
```

其中：

* `表达式1` 的值为循环变量的初值
* `表达式2` 的值为步长。步长为 1 时，`表达式2` 可以省略
* `表达式3` 的值为循环变量的终值

### while 语句

```matlab
while (条件)
    循环体语句
end
```

## 函数文件

### 函数创建

函数文件是另一种形式的 M 文件，每一个函数文件都定义一个函数。
函数文件由 `function` 语句引导，其格式为：

```matlab
function 输出形参标=函数名(输入形参表)
    注释说明部分
    函数体
```

其中：

* `函数名` 的命名规则与变量名相同
* `输入形参` 为函数的输入参数
* `输出形参` 为函数的输出参数。当`输出形参`多于 1 个时，则应该用方括号括起来

示例：

```matlab
function f = ffib(n)
    % 用于求 Fibonacci 数列的函数文件
    f = [1, 1];
    i = 1;
    while f(i) + f(i + 1) < n
        f(i + 2) = f(i) + f(i + 1);
        i = i + 1;
    end
```

### 函数调用

```matlab
[输出实参表]=函数名(输入实参表)
```

## 全局变量和局部变量

在 MATLAB 中，全局变量用命令 `global` 定义。

* 函数文件的内部变量是局部的，与其他函数文件及 MATLAB 工作空间相互隔离
* 如果在多个函数中，都把某一变量定义为全局变量，那么这些函数将公用这一个变量
* 全局变量的作用域是整个 MATLAB 工作空间，即全程有效。

# 参考

* [matlab入门图文教程](https://zhuanlan.zhihu.com/p/77669451)
